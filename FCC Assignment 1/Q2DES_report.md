The code steps are illustrated by comments.

The whole procedure is following: https://en.wikipedia.org/wiki/Data_Encryption_Standard

The permutation table, compression table and S box table are based on: https://en.wikipedia.org/wiki/DES_supplementary_material